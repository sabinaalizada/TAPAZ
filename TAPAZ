CREATE DATABASE TAPAZ

GO

USE TAPAZ

CREATE TABLE BRANDS
(
Id INT IDENTITY PRIMARY KEY,
Name NVARCHAR(17) NOT NULL,
)

CREATE TABLE MODELS
(
Id INT IDENTITY PRIMARY KEY,
Name NVARCHAR(20) NOT NULL,
BrandId INT REFERENCES BRANDS(Id)
)

CREATE TABLE PHONES
(
Id INT IDENTITY PRIMARY KEY,
Price INT NOT NULL CHECK(Price>0),
Memory INT NOT NULL CHECK(Memory>0),
ModelId INT REFERENCES MODELS(Id)
)


CREATE TABLE COLORS
(
Id INT IDENTITY PRIMARY KEY,
Name NVARCHAR(20) NOT NULL,
)

CREATE TABLE PHONECOLORS
(
Id INT IDENTITY PRIMARY KEY,
PhoneId INT REFERENCES PHONES(Id),
ColorId INT REFERENCES COLORS(Id)
)

CREATE TABLE FEATURES
(
Id INT IDENTITY PRIMARY KEY,
Name NVARCHAR(20) NOT NULL,
)
CREATE TABLE PHONEFEATURES
(
Id INT IDENTITY PRIMARY KEY,
PhoneId INT REFERENCES PHONES(Id),
FeaturesId INT REFERENCES FEATURES(Id)
)

INSERT INTO BRANDS
VALUES
('APPLE'),
('SAMSUNG'),
('XIOMI')

INSERT INTO MODELS
VALUES
('13 PRO MAX',1),
('11',1),
('GALAXY A7',2),
('NOTE 7',2),
('MI 2',3),
('RED MI 9T',3)

INSERT INTO PHONES
VALUES
(1650,64,1),
(1000,32,6),
(2000,128,5),
(1789,64,2),
(2879,256,3),
(2678,64,4)


INSERT INTO COLORS
VALUES
('black'),
('yellow'),
('white')

INSERT INTO FEATURES
VALUES
('FACE ID'),
('FINGER ID'),
('WIFI')

INSERT INTO PHONEFEATURES
VALUES
(6,1),
(2,1),
(1,2),
(4,3),
(3,1),
(5,2)

INSERT INTO PHONECOLORS
VALUES
(6,1),
(1,1),
(2,2),
(4,3),
(5,1),
(3,2)


SELECT  P.Price,P.Memory,C.Name AS COLOR,F.Name AS FEATURES,M.Name  AS MODEL,B.Name AS BRAND FROM PHONES AS P
JOIN PHONECOLORS AS PC ON P.Id=PC.PhoneId
JOIN COLORS AS C ON PC.ColorId=C.Id
JOIN PHONEFEATURES AS PF ON P.Id=PF.PhoneId
JOIN FEATURES AS F ON F.Id=PF.FeaturesId
JOIN MODELS AS M ON M.Id=P.ModelId
JOIN BRANDS AS B ON B.Id=M.BrandId
